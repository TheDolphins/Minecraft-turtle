function isInFrontOf(name)
  local success,data = turtle.inspect();
  return success and data.name==name;  
end

-- cut the tree above
function cutUp()
  if turtle.digUp() then
    return 1
  else
    return 0
  end
end

-- cut the tree in front
function cut()
  if isInFrontOf("minecraft:log") or isInFrontOf("minecraft:leaves") then
    turtle.dig();
    return 1
  else
    return 0
  end
end

-- cut the tree in front and move forward
function cutAndForward()
  local i = cut()
  turtle.forward();
  return i
end

-- cut the tree on the right and come back to the same direction
function cutToRight()
  turtle.turnRight()
  local i = cut()
  turtle.turnLeft()
  return i
end

-- refuel if there's coal in inventory
-- (we don't want to use sapling as fuel)
function refuel()
  if select("minecraft:coal") then
    turtle.refuel()
  end
end

function cutDownTree()
  -- place the turtle under the tree
  turtle.dig();
  turtle.forward();
  
  while true do
    for i=1,4 do
      if isInFrontOf("minecraft:log") or isInFrontOf("minecraft:leaves") then
        turtle.dig();
      end
      turtle.turnLeft();
    end
    
    if turtle.detectUp() then
      -- go up one more level and keep cutting
      turtle.digUp();
      turtle.up()
    else
      -- if we are done, come all the way down to the ground
      while not turtle.detectDown() do
        turtle.down();
      end
      turtle.back();
      
      -- then plant a sapling
      if not select("minecraft:sapling") then
        die("No more sapling")
      end
      turtle.place();
      
      return;
    end
  end
end
  
-- select the specified block (by block name) from the inventory
-- return true if selected successfully
function select(name)
  for i=1,16 do
    turtle.select(i)
    local detail = turtle.getItemDetail();
    if detail and detail.name==name then
      return true
    end
  end
  return false
end

-- assuming we face a chest, put away all the logs
function putAwayLogs()
  while select("minecraft:log") do
    turtle.drop()
  end
end

-- is it bright outside?
function duringDayTime()
  local t = os.time()
  return t>=6 and t<=18
end

-- main loop
local c=0
while true do
  if duringDayTime() then
    if isInFrontOf("minecraft:cobblestone") then
      -- block is in front of us. turn around
      turtle.turnLeft();
      turtle.turnLeft();
      print("fuel level: " .. turtle.getFuelLevel())
    else
      -- is there a tree on left? if so, cut that down
      turtle.turnLeft();
      if isInFrontOf("minecraft:log") then
        cutDownTree();
      end
      if isInFrontOf("minecraft:chest") then
        putAwayLogs()
      end
      turtle.turnRight();
      turtle.forward();
    end
  else
    os.sleep(10)
  end

  c=c+1
  if (c%16)==0 then
    refuel()
  end
end

